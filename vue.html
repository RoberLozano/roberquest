<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/@mdi/font@4.x/css/materialdesignicons.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
  <style>
    .green {
      background-color: green;
    }
  </style>
</head>

<body>
  <div id="app">
    <v-app>
      <v-main>

        <template>
          <v-app-bar dark>
            <v-app-bar-nav-icon @click="drawer = true"></v-app-bar-nav-icon>

            <v-toolbar-title>{{nombrePersonaje||'Roberquest'}}</v-toolbar-title>
            <v-spacer></v-spacer>

            <v-btn icon @click="act()">
              <v-icon>mdi-magnify</v-icon>
            </v-btn>

          </v-app-bar>



          <v-navigation-drawer v-model="drawer" absolute temporary>
            <v-list nav>
              <v-list-item-group v-model="group" active-class="red--text text--accent-4">
                <v-list-item>
                  <v-list-item-icon>
                    <v-icon>mdi-home</v-icon>
                  </v-list-item-icon>
                  <v-list-item-title>Home</v-list-item-title>
                </v-list-item>

                <v-list-item>
                  <v-list-item-icon>
                    <v-icon>mdi-account</v-icon>
                  </v-list-item-icon>
                  <v-list-item-title>Account</v-list-item-title>
                </v-list-item>



                <v-list-item>
                  <v-list-item-icon>
                    <v-icon>mdi-account</v-icon>
                  </v-list-item-icon>

                  <v-select v-model="nombrePersonaje" :items="ls('personajes')" label="Personaje"
                    @change="pj= Clase.convertir(ls(nombrePersonaje));pj.actTodosBonHab();p=pj; contenedor=pj.inventario">
                  </v-select>
                </v-list-item>



              </v-list-item-group>
            </v-list>
          </v-navigation-drawer>




          <template>
            <v-card>
              <v-tabs color="red accent-4" show-arrows>
                <v-tab>Personaje</v-tab>
                <v-tab>Habilidades</v-tab>
                <v-tab>Inventario</v-tab>
                <v-tab>Combate</v-tab>
                <v-tab>Magia</v-tab>
              
  
            
                <!-- Personaje -->
                <v-tab-item>
                  <v-container fluid>
                    <h2>Características</h2><br>
                    <v-row>
                      <table>
                        <tr hidden>
                          <td>_FUE</td>
                          <td><input type="number" v-model="p._FUE"></td>
                        </tr>

                        <tr v-for="(c,index) in CP">
                          <td>{{ c }}</td>
                          <td><input :style="{ 'color': 'white','width': '3em'}" type="number" v-model="pj[c]"></td>

                          <td><input type="number" v-model="pj.bonificacion[c]"
                              :style="{ 'color': (pj.bonificacion[c]>0 ? 'green' : 'red') ,'width': '2.5em'}">
                          </td>
                          <td>{{pj.getCar(c) }}</td>
                          <td> </td>
                          <td>{{TipoHabilidades[index]}}</td>
                          <td>{{pj.getCar(TipoHabilidades[index])}}</td>


                        </tr>

                        <tr> </tr>
                      </table>
                    </v-row>
                    <v-row>
                      <v-col  sm="1"> <v-text-field v-model="pj.PG" type="number" label="PG" size="1">{{pj.PG}}</v-text-field> </v-col>
                      <v-col  sm="1"> <v-text-field v-model="pj.PF" type="number" label="PF" size="1">{{pj.PF}}</v-text-field> </v-col>
                      <v-col  sm="1"> <v-text-field v-model="pj.PM" type="number" label="PM" size="1">{{pj.PM}}</v-text-field> </v-col>
                        
                        
                        
                      


                    </v-row>
                  </v-container>
                </v-tab-item>

                <!-- Tab Habilidades -->
                <v-tab-item>
                  <v-container fluid>
                    <v-row>
                      <!-- tabla habilidades -->
                      <v-row justify="center">
                        <v-expansion-panels accordion dark>
                          <v-expansion-panel>
                            <v-expansion-panel-header>Habilidades</v-expansion-panel-header>
                            <v-expansion-panel-content>
                              <template>

                                <v-data-table dense dark hide-default-footer :headers="headers"
                                  :items="pj.getHabilidades()" :custom-sort="subirSort" multi-sort show-group-by
                                  :items-per-page="-1" class="elevation-1" show-expand :single-expand="singleExpand"
                                  :expanded.sync="expanded" :search="search" item-key="nombre" :mobile-breakpoint=200>

                                  <template v-slot:item.xp="props">
                                    <v-edit-dialog :return-value.sync="props.item.xp" large persistent>

                                      <td :style="{color: props.item.xp>4?'red':'green'}">{{props.item.xp}}</td>
                                      <template v-slot:input>
                                        <div class="mt-4 text-h6">
                                          Cambiar XP
                                        </div>
                                        <input type="number" v-model.number="props.item.xp"
                                          :style="{color: props.item.xp>4?'green':'red'}">
                                      </template>
                                    </v-edit-dialog>
                                  </template>

                                  <template v-slot:item.v="{ item }">
                                    <!-- <p :style="{color: getColor(item.v)}">{{item.v}}</p> -->
                                    <td :style="{color: item.v>100?'green':(item.v>10?'inherit':'red')}">{{item.v}}</td>
                                  </template>

                                  <template v-slot:item.sub="{ item }">
                                    <!-- <p :style="{color: getColor(item.v)}">{{item.v}}</p> -->
                                    <td v-if="item.subible()<100"
                                      :style="{color: item.subible()>=100?'red':(item.subible()>50?'inherit':'green')}">
                                      <b>{{item.subible()}} {{item.subible()>50?'&uarr;':'&#x21C8;'}}</b>
                                    </td>
                                  </template>

                                  <template v-slot:top>
                                    <v-toolbar flat>
                                      <v-text-field v-model="search" append-icon="mdi-magnify" label="Buscar"
                                        single-line hide-details>
                                      </v-text-field>
                                      <v-switch v-if="0 === 1" v-model="singleExpand" label="Single expand"
                                        class="mt-2"></v-switch>
                                    </v-toolbar>
                                  </template>


                                  <template v-slot:expanded-item="{ headers, item }">
                                    <td :colspan="headers.length">
                                      {{item.clase}} de tipo {{item.tipo}} con xp:{{item.xp}} subido por ultima vez
                                      {{item.fecha}}
                                    </td>
                                  </template>

                                </v-data-table>
                              </template>
                            </v-expansion-panel-content>
                          </v-expansion-panel>
                        </v-expansion-panels>
                      </v-row>
                    </v-row>
                  </v-container>
                </v-tab-item>

                <!-- Tab Inventario -->
                <v-tab-item>
                  <v-container fluid>


                    <!-- tabla inventario  sin: item-key="nombre"  se necesita para el expandable-->
                    <v-row justify="center">
                      <v-expansion-panels accordion dark>
                        <v-expansion-panel>
                          <v-expansion-panel-header>Inventario ({{contenedor.pesa}}kg)</v-expansion-panel-header>
                          <v-expansion-panel-content>
                            <template>

                              <v-data-table dense dark hide-default-footer :headers="headerInventario"
                                :items="contenedor.objetos" :custom-sort="subirSort" show-group-by :items-per-page="-1"
                                class="elevation-1"
                                v-model="selected" show-select :search="search" item-key="nombre"
                                :mobile-breakpoint=200>

                                <template v-slot:item.nombre="{ item }">
                                  <v-edit-dialog :return-value="item.nombre">
                                    {{ item.nombre }}

                                    <div style="display: inline" v-if="item.clase == 'Contenedor'" @click="abrir(item)">
                                      <v-icon v-if="item.clase == 'Contenedor'" small @click="abrir(item)">
                                        mdi-delete
                                      </v-icon>
                                      <v-badge :content="item.carga+'/'+item.max + 'kg'"
                                        :color="interColor(item.carga,item.max,true)" inline>
                                        <!-- {{item.carga}}/{{item.max}} -->
                                      </v-badge>
                                    </div>


                                    <template v-slot:input>
                                      <input v-model.lazy="item.nombre" :style="{color: 'white'}" />
                                    </template>

                                  </v-edit-dialog>


                                </template>

                                <template v-slot:item.ctd="props">
                                  <v-edit-dialog :return-value.sync="props.item.ctd" large persistent>

                                    <td>{{props.item.ctd}}</td>
                                    <template v-slot:input>


                                      <div class="mt-4 text-h6">
                                        Cambiar Cantidad
                                      </div>



                                      <v-text-field v-model.number="props.item.ctd" label="ctd" class="mt-0 pt-0"
                                        hide-details single-line type="number" counter autofocus>
                                      </v-text-field>



                                      <v-slider v-model="sliderSeparar" hint="Objetos a separar" :max="props.item.ctd"
                                        min="0" thumb-label>
                                      </v-slider>
                                      <v-btn icon color="green"
                                        @click="contenedor.add(props.item.separar(sliderSeparar)); sliderSeparar=0">
                                        <v-icon>mdi-check-outline</v-icon>
                                      </v-btn>




                                      <!-- <input type="number" v-model.number="props.item.ctd" :style="{color: props.item.ctd>4?'green':'red'}"> -->
                                    </template>
                                  </v-edit-dialog>
                                </template>

                                <template v-slot:item.peso="{ item }">
                                  <!-- <p :style="{color: getColor(item.v)}">{{item.v}}</p> -->
                                  <td>{{item.peso}}</td>
                                </template>


                                <!-- <template v-slot:item.valor="{ item }">
                                  
                                            <td>
                                              <b>{{item.valor}}</b>
                                            </td>
                                          </template> -->

                                <template v-slot:top>
                                  <v-toolbar flat>
                                    <v-icon v-if="abiertos.length>0" @click="contenedor=pj.inventario;abiertos=[]">
                                      mdi-reply-all
                                    </v-icon>
                                    <v-icon v-if="abiertos.length>0" @click="anterior">mdi-reply</v-icon>
                                    <li v-for="(item, index) in abiertos">
                                      <!-- <a>{{ index }} - {{ item.nombre }}</a> -->
                                      <v-btn small text @click="abrir(item,index)">{{item.nombre}}</v-btn>\
                                    </li>
                                    <v-btn small text v-if=contenedor>{{contenedor.nombre}}</v-btn>
                                    <!-- <v-spacer></v-spacer>
                                    <div v-if=contenedor>{{contenedor.nombre}}</div> -->
                                    <v-spacer></v-spacer>


                                    <v-icon @click="verBuscar=!verBuscar">mdi-magnify</v-icon>
                                    <v-switch v-if="0 === 1" v-model="singleExpand" label="Single expand" class="mt-2">
                                    </v-switch>
                                  </v-toolbar>
                                  <v-text-field v-if="verBuscar" v-model="search" append-icon="mdi-magnify"
                                    label="Buscar" single-line hide-details clearable></v-text-field>
                                </template>

                                <!-- footer -->
                                <template v-if="selected.length>0" v-slot:footer>
                                  <div>
                                    {{selected.length}} objetos seleccionados,
                                    {{selected.reduce((a, b) => a + (b.pesa || 0), 0)}} kgs,
                                    {{selected.reduce((a, b) => a + (b.valor || 0), 0)}} mp
                                    <v-btn @click="sheet = !sheet">Mover</v-btn>
                                    <v-btn @click="selected.forEach(i => {contenedor.sacar(i)});selected=[];">Tirar
                                    </v-btn>
                                  </div>
                                </template>

                                <template v-slot:expanded-item="{ headerInventario, item }">
                                  <td :colspan="headers.length">
                                    {{item.clase}} {{item.nombre}} pesa {{item.pesa}} y vale {{item.valor}}
                                  </td>
                                </template>

                              </v-data-table>
                            </template>
                          </v-expansion-panel-content>
                        </v-expansion-panel>
                      </v-expansion-panels>
                    </v-row>

                    <!-- tabla inventario  sin: item-key="nombre"  se necesita para el expandable-->
                    <v-row justify="center">
                      <v-expansion-panels accordion dark>
                        <v-expansion-panel>
                          <v-expansion-panel-header>Inventario ({{(contenedor.pesa).toFixed(2)}}kg)
                          </v-expansion-panel-header>
                          <v-expansion-panel-content>
                            <template>

                              <v-autocomplete v-model="value" :items="headerInventario" deletable-chips multiple
                                small-chips return-object>
                              </v-autocomplete>


                              <v-data-table dense dark hide-default-footer multi-sort :headers="selectedHeaders"
                                :items="contenedor.objetos" class="elevation-1" :items-per-page="-1">
                              </v-data-table>
                            </template>
                          </v-expansion-panel-content>
                        </v-expansion-panel>
                      </v-expansion-panels>
                    </v-row>


                  </v-container>
                </v-tab-item>

                <!-- Tab Combate -->
                <v-tab-item>
                  <v-container fluid>
                    Técnicas
                    <v-autocomplete :items="pj.getClaseHabilidad(Tecnica)" deletable-chips multiple small-chips
                      return-object item-text="nombre">

                      <template v-slot:item="{item}">
                        <v-list-item-avatar color="green" class="text-h6 font-weight-light white--text">
                          {{ item.pf }}
                        </v-list-item-avatar>
                        {{item.nombre}} <v-spacer></v-spacer> <span :style="{color: getColor(item.v)}">
                          {{item.v}}%</span>
                      </template>
                    </v-autocomplete>

                    Habilidades Marciales
                    <v-autocomplete :items="pj.getClaseHabilidad(HabilidadMarcial)" deletable-chips multiple small-chips
                      return-object item-text="nombre">

                      <template v-slot:item="{item}">
                        {{item.nombre}} <v-spacer></v-spacer> <span :style="{color: getColor(item.v)}">
                          {{item.v}}%</span>
                      </template>
                    </v-autocomplete>

                    <v-row>
                      <v-text-field v-model="filtro" append-icon="mdi-magnify" label="Buscar" single-line hide-details
                        clearable>
                      </v-text-field>
                      Filtro
                      <v-autocomplete v-model="habilidadFiltro"
                        :items="pj.getHabilidades(parseStringToFunction(filtro))" return-object item-text="nombre">

                        <template v-slot:item="{item}">
                          {{item.nombre}} <v-spacer></v-spacer> <span :style="{color: getColor(item.v)}">
                            {{item.v}}%</span>
                        </template>
                      </v-autocomplete>

                      <!-- <v-text-field v-model="habilidadFiltro.nombre" label="Nombre">
                  </v-text-field> -->

                      <!-- <v-text-field v-model="habilidadFiltro.valor" label="valor" >
                  </v-text-field> -->

                      <v-text-field v-model="habilidadFiltro.v" label="%" size="1">
                      </v-text-field>

                      <v-text-field v-model="dado" :label="TipoTirada.tirada[habilidadFiltro.tirada(dado)]" size="1"
                        :color="getColor(dado)"
                        @click="dado=d100.tirar(); iuDaño.dado=arma.daño.tirar(habilidadFiltro.tirada(dado))"
                        @input="iuDaño.dado=arma.daño.tirar(habilidadFiltro.tirada(dado))">

                      </v-text-field>

                      <!-- <v-text-field v-model="TipoTirada.tirada[habilidadFiltro.tirada(dado)]" label="Tirada" size="1"  >
                  </v-text-field> -->

                      <v-btn icon color="green"
                        @click="habilidadFiltro.xpTipoTirada(habilidadFiltro.tirada(dado),dado)">
                        <v-icon>mdi-check-outline</v-icon>
                      </v-btn>

                    </v-row>

                    <v-row>
                      Arma
                      <v-autocomplete v-model="arma" :items="pj.inventario.darClaseRecursiva(Arma)" return-object
                        item-text="nombre">
                        <template v-slot:item="{item}">

                          <v-list-item-avatar color="indigo" class="text-h6 font-weight-light white--text">
                            {{ item.peso }}
                          </v-list-item-avatar>
                          <v-list-item-content>
                            <v-list-item-title v-html="item.nombre"></v-list-item-title>
                            <v-list-item-subtitle v-html="item.daño"></v-list-item-subtitle>
                          </v-list-item-content>


                          <v-list-item-action>
                            <v-list-item-action-text v-text="item.peso+'kg'"></v-list-item-action-text>


                          </v-list-item-action>

                        </template>
                      </v-autocomplete>

                      <!-- <v-text-field v-model="arma.daños" label="%" size="1">
                      </v-text-field> -->

                      <v-select v-model="daño" :items="arma.daños" label="Daño" return-object
                        @change="arma.daño=daño.dado; console.log(arma.daño.dado)">

                      </v-select>

                      <v-text-field v-model="iuDaño.dado" :label="daño" size="1" :color="getColor(dado)"
                        @click="iuDaño.dado=arma.daño.tirar()">

                      </v-text-field>

                      <!-- <v-text-field v-model="TipoTirada.tirada[habilidadFiltro.tirada(dado)]" label="Tirada" size="1"  >
                  </v-text-field> -->

                      <v-btn icon color="green"
                        @click="habilidadFiltro.xpTipoTirada(habilidadFiltro.tirada(dado),dado)">
                        <v-icon>mdi-check-outline</v-icon>
                      </v-btn>

                    </v-row>

                  </v-container>
                </v-tab-item>


                <!-- Tab magia -->
                <v-tab-item>
                  <v-container fluid>
                    <v-row>
                      <v-autocomplete :items="pj.getClaseHabilidad('Arte')" label="Artes" deletable-chips multiple
                        small-chips return-object item-text="nombre">
                      </v-autocomplete>
                    </v-row>

                    <v-row>
                      <div id="dh"> HAz algo</div>
                    </v-row>

                    <v-row>

                      <template>

                        <v-row>
                          <v-col cols="12" sm="4">

                            <!-- <v-text-field v-model="hechizo.nombre" color="purple darken-2" label="Nombre" required>
                            </v-text-field> -->

                            <v-autocomplete v-model="hechizo" :items="pj.getClaseHabilidad('Hechizo')" label="Hechizo"
                              color="blue-grey lighten-2" return-object item-text="nombre"
                              @click="copiarHechizo(hechizo)">

                              <template v-slot:item="{item}">

                                <v-list-item-avatar color="indigo" class="text-h5 font-weight-light white--text">
                                  {{ item.pm }}
                                </v-list-item-avatar>
                                <v-list-item-content>
                                  <v-list-item-title v-html="item.nombre +'  '+item.v+'%'"></v-list-item-title>
                                  <v-list-item-subtitle v-html="item.v+'%'">%</v-list-item-subtitle>
                                </v-list-item-content>


                                <v-list-item-action>
                                  <v-list-item-action-text v-text="item.v+'%'"></v-list-item-action-text>


                                </v-list-item-action>


                              </template>
                            </v-autocomplete>
                          </v-col>


                          <v-col cols="12" sm="1">
                            <v-text-field v-model="hechizo.pm" type="number" color="blue darken-2" label="PM" required>
                            </v-text-field>
                          </v-col>


                          <v-col cols="12" sm="1">
                            <v-text-field v-model="hechizo.valor" type="number" color="blue darken-2" label="Valor"
                              required>
                            </v-text-field>
                          </v-col>


                          <v-col cols="12" sm="4">
                            <v-slider v-model="hechizo.v" color="orange" label="Total" hint="Be honest" min="1"
                              max="300" thumb-label="always"></v-slider>
                          </v-col>


                        </v-row>
                      </template>

                    </v-row>

                    <v-row>
                      <v-btn @click="iuHechizo()">IU</v-btn>
                      <div id="divHechizo"></div>
                    </v-row>

                  </v-container>
                </v-tab-item>
              
            </v-tabs>

              
            </v-card>
          </template>



        </template>
        <!-- calendario -->
        <template>
          <v-row>
            <v-col cols="12" sm="6" md="4">
              <v-menu :close-on-content-click="true" :nudge-right="40" transition="scale-transition" offset-y
                min-width="auto">
                <template v-slot:activator="{ on, attrs }">
                  <v-text-field v-model="date" label="Fecha" prepend-icon="mdi-calendar" readonly v-bind="attrs"
                    v-on="on">
                  </v-text-field>
                </template>
                <v-date-picker v-model="date" dark locale='es'></v-date-picker>
              </v-menu>
            </v-col>

            <v-spacer></v-spacer>
          </v-row>
        </template>

        <!-- hora -->


        <!-- grafico -->
        <!-- <template>
          <v-card class="mx-auto text-center" dark max-width="600">
            <v-card-text>
              <v-sheet>
                <v-sparkline :value="value" color="white" height="100" padding="24" stroke-linecap="round" line-width=1>
                  <template v-slot:label="item">
                    {{ item.value }}%
                  </template>
                </v-sparkline>
              </v-sheet>
            </v-card-text>

            <v-card-text>
              <div class="text-h4 font-weight-thin">
                Subida en {{habilidad}}
              </div>
            </v-card-text>

            <v-divider></v-divider>

            <v-card-actions class="justify-center">
              <v-btn block text>
                Go to Report
              </v-btn>
            </v-card-actions>
          </v-card>
        </template> -->



        <!-- Bottomsheet -->
        <v-bottom-sheet v-model="sheet" persistent>

          <v-sheet class="text-center" height="200px">
            <div class="py-3">
              Elige donde mover
              <v-select v-model="contenedorMover" :items="pj.inventario.darContenedores()" label="contenedor"
                return-object
                @change="selected.forEach(i => {contenedor.mover(i,contenedorMover)});selected=[];sheet = !sheet">
                <template v-slot:selection="{ item, index }">
                  {{ item.nombre }}
                </template>

                <template v-slot:item="{ item}">
                  {{ item.nombre }} <v-badge :content="item.carga+'/'+item.max + 'kg'"
                    :color="interColor(item.carga,item.max,true)" inline>
                    {{item.carga}}/{{item.max}}
                  </v-badge>
                </template>

              </v-select>
            </div>
          </v-sheet>
        </v-bottom-sheet>

      </v-main>
    </v-app>
  </div>



  <script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.js"></script>

  <!-- scrips del rol -->
  <script src='js/utils.js'></script>
  <script src='js/D.js'></script>
  <script src='js/habilidades.js'></script>
  <script src='js/inventario.js'></script>
  <script src='js/localizaciones.js'></script>
  <script src='js/armaduras.js'></script>
  <script src='js/rol.js'></script>

  <script>
    // var chaleco = new Pieza(["Pecho", "Abdomen"], 3);
    // var vestidoDragon = new Armadura(
    //   [new Pieza(dartodasLocalizaciones(pj, 'Craneo', 'Cara', 'Pie I', 'Pie D', 'Mano I', 'Mano D'), 7),
    //     chaleco]
    // );

    new Vue({
      el: '#app',
      vuetify: new Vuetify({
        theme: {
          dark: true,
        },
      }),
      methods: {

        act() {
          pj.act();
          this.p = pj;

        },
        //METODOS DE GUARDAR

        save() {
          console.log('Data saved')

        },
        cancel() {
          console.log('Dialog closed')
        },
        open() {
          console.log('Dialog closed')
        },
        close() {
          console.log('Dialog closed')
        },

        parseStringToFunction(func) {

          // console.log(func);
          if (!func || func.length < 1) return undefined;
          if ((func.includes("=>")))
            return (new Function('return ' + func)());
          else
            return (new Function('return ' + 'obj=>obj.' + func)());
        },

        tirada() {
          return this.habilidadFiltro.tirada(this.dado);
        },

        copiarHechizo(obj) {

          this.copiaHechizo = new Hechizo();
          this.copiaHechizo.setAll(obj);
          this.copiaHechizo.valor += 10;
          console.log(this.copiaHechizo);
        },

        iuHechizo(){
        //  let dv= document.getElementById('divHechizo');
        //  let ih = new InputHechizo(this.copiaHechizo,true);


        //  let ia = new InputArte(this.copiaHechizo,true);
        //  ia.setPersonaje(pj);
        //  ia.setHabilidad(pj.getHabilidad('Intensidad'));

        //  ih.setPersonaje(pj);
        //  ih.setHabilidad(this.copiaHechizo);
        //  ih.setArte(ia);
        //  dv.appendChild(ia);

        // dv.appendChild(btn);
        //  dv.appendChild(ih);
        IUHechizos(pj,'divHechizo',true);


        },

        abrir(contenedor, index) {
          if (contenedor instanceof Contenedor) {
            console.log(contenedor);

            if (index || index == 0) {
              this.abiertos.splice(index);
            } else {
              this.abiertos.push(this.contenedor)
            }

            this.contenedor = contenedor;

          }
        },

        anterior(contenedor) {
          if (this.abiertos.length > 0) {
            this.contenedor = this.abiertos.pop()

          }
        },

        interColor(min, max, inverso = false) {
          let p = min / max;
          if (inverso) p = 1 - p;
          p = p * 100;

          if (p > 78) return 'green'
          else if (p < 10) return 'red'
          else if (p < 40) return 'orange'
          else if (p > 50) return 'inherit'
          else return ''

        },

        getColor(v) {
          if (v > 100) return 'green'
          else if (v < 10) return 'red'
          else if (v < 40) return 'orange'
          else if (v > 50) return 'inherit'
          else return ''
        },
        subirSort(items, index, isDesc) {
          items.sort((a, b) => {
            // console.log(index[0]);
            if (index[0] === "sub") {
              // return a.subible() - b.subible()
              return a.subible() - b.subible()
            } else {
              return a[index[0]] < b[index[0]] ? -1 : 1;
            }
          });

          if (isDesc[0]) return items.reverse()
          return items;
        },
      },




      watch: {
        value(val) {
          this.selectedHeaders = val;
          console.log(val);
        }
      },
      created() {
        this.selectedHeaders = this.headerInventario;
        console.log(this.selectedHeaders);
      },
      data: {

        //drawer
        drawer: false,
        group: null,

        expanded: [],
        singleExpand: false,
        verBuscar: false,
        search: '',
        abiertos: [],
        max25chars: v => v.length <= 25 || 'Nombre largo',
        headers: [
          {
            text: 'Nombre ',
            align: 'start',
            groupable: false,
            value: 'nombre'
          },

          { text: 'XP', value: 'xp', groupable: false },
          // { text: 'Categoria', value: 'tipo' },
          // { text: 'Clase', value: 'clase' },
          { text: 'Valor', value: 'valor', groupable: false },
          { text: 'Total', value: 'v', groupable: false },
          { text: 'Subir', value: 'sub', groupable: false },
          { text: '', value: 'data-table-expand', groupable: false },
        ],
        headerInventario: [
          {
            text: 'Nombre ',
            align: 'start',
            groupable: false,
            value: 'nombre'
          },

          { text: 'Ctd', value: 'ctd', groupable: false },
          // { text: 'Categoria', value: 'tipo' },
          { text: 'Clase', value: 'clase' },
          { text: 'Peso', value: 'peso', groupable: false },
          { text: 'Valor', value: 'valor', groupable: false },

        ],
        p: pj,
        nombrePersonaje: '',
        ct: constante,
        contenedor: pj.inventario,
        hechizo: new Hechizo('Hechizo'),
        // picker: (new Date(Date.now() - (new Date()).getTimezoneOffset() * 60000)).toISOString().substr(0, 10),
        date: fechaMundo.fecha(),
        dialog: false,
        hidden: false,
        selected: [],//inventario selected
        filtro: "",
        habilidadFiltro: new Habilidad(),
        arma: new Arma(),
        daño: [],
        dado: 100,
        iuDaño: { dado: 0, daño: [] },
        dadoDaño: 0,
        d100: new Dado('1d100'),
        copiaHechizo: new Hechizo(),

        value: [],
        selectedHeaders: [],

        sliderSeparar: 0,

        sheet: false, //bottom sheet mover
        contenedorMover: null,

        //GENERAL,
        // arrayHeaders:["nombre"],
        // arrayItems:pj.inventario.objetos,

      }
    })


  </script>
</body>

</html>